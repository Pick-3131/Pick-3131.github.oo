<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>ควยเมฆ</title>
<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
}
canvas{
  display:block;
}
</style>
</head>
<body>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

let w, h;
function resize(){
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

/* SETTINGS */
const text = "ควยโฟร์น";
const fontSize = 140;
const particles = [];
const mouse = { x:-9999, y:-9999, r:120 };

/* FONT (ไม่มี $ ไม่มี template string) */
ctx.font = "900 140px Impact";
ctx.textAlign = "center";
ctx.textBaseline = "middle";

/* CREATE PARTICLES */
function createText(){
  particles.length = 0;
  ctx.clearRect(0,0,w,h);
  ctx.fillStyle = "#ffffff";
  ctx.fillText(text, w/2, h/2);

  const data = ctx.getImageData(0,0,w,h).data;
  ctx.clearRect(0,0,w,h);

  for(let y=0;y<h;y+=4){
    for(let x=0;x<w;x+=4){
      const i = (y*w + x) * 4;
      if(data[i+3] > 150){
        particles.push({
          x:x, y:y,
          ox:x, oy:y,
          vx:0, vy:0
        });
      }
    }
  }
}
createText();

/* INPUT */
window.addEventListener("mousemove", e=>{
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});
window.addEventListener("touchmove", e=>{
  mouse.x = e.touches[0].clientX;
  mouse.y = e.touches[0].clientY;
},{passive:true});
window.addEventListener("mouseleave", ()=>{
  mouse.x = mouse.y = -9999;
});

/* LOOP */
function animate(){
  ctx.clearRect(0,0,w,h);
  ctx.fillStyle = "#00ffff";

  for(const p of particles){
    const dx = p.x - mouse.x;
    const dy = p.y - mouse.y;
    const dist = Math.sqrt(dx*dx + dy*dy);

    if(dist < mouse.r){
      const force = (mouse.r - dist) / mouse.r;
      const angle = Math.atan2(dy, dx);
      p.vx += Math.cos(angle) * force * 6;
      p.vy += Math.sin(angle) * force * 6;
    }

    p.vx += (p.ox - p.x) * 0.02;
    p.vy += (p.oy - p.y) * 0.02;

    p.vx *= 0.88;
    p.vy *= 0.88;

    p.x += p.vx;
    p.y += p.vy;

    ctx.fillRect(p.x, p.y, 2, 2);
  }

  requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
